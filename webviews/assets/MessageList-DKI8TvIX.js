import{S as Y,d as J,e as X,h as ne,j as w,k as C,l as E,n as F,m as M,a5 as Ee,y as L,z as x,Q as B,_ as Ae,E as N,A as y,ai as rt,b as g,a as A,t as p,c as T,B as b,a0 as Te,a2 as He,a4 as U,ad as V,a7 as G,aj as Ne,K as Fe,$ as pe,o as Be,D as Re,ag as ze,ak as qe,Z as lt,T as re,Y as Ue,I as ot,af as se}from"./index-p4Dt6o3z.js";import{e as O,u as at,o as ct}from"./ButtonAugment-DueOA3_V.js";import{G as it,t as ut,a as mt,M as $t,e as gt,f as pt,S as dt,A as ft,C as ht,g as vt,U as wt,h as We,E as xt,i as yt,R as bt,j as Ct,k as Mt}from"./MessageListBottomButton-DmSVyLmH.js";import{a as jt}from"./Content-7zb4jZEH.js";import{S as le,A as Q,i as oe,a as De,b as Ze,c as Oe,d as Ge,e as Ve,f as Ke,g as Pe,h as Qe,j as ae,k as _t,E as Ye,T as Je,l as de}from"./chat-context-Dq8CyOam.js";import{R as Xe,O as St,M as Lt,D as kt}from"./circle-backslash-B3nG_JMr.js";import"./isObjectLike-Dcghr38G.js";import{S as It}from"./main-panel-BDgbRPZU.js";import{aI as Et,aG as At,aH as Tt}from"./AugmentMessage-x438MRdb.js";import{C as Ht,R as fe,a as q}from"./CollapseButtonAugment-C3mt1EeR.js";import{T as Nt}from"./TextTooltipAugment-C0ygVke5.js";import{I as et}from"./IconButtonAugment-B0XoCIXT.js";import{E as Ft}from"./expand-Ccnb8uFO.js";import{s as he}from"./index-DwagmzSc.js";import"./MaterialIcon-9THX1buP.js";import"./keypress-DD1aQVr0.js";import"./autofix-state-d-ymFdyn.js";import"./Keybindings-BPBUBuVi.js";import"./index-CkBhOCxh.js";import"./exclamation-triangle-BQxrhBcR.js";import"./pen-to-square-DUXCbbi7.js";import"./augment-logo-C66YBCMf.js";import"./globals-D0QH3NT1.js";import"./file-paths-BEF4tZXQ.js";import"./design-system-init-Bqt81Pxb.js";import"./magnifying-glass-Dmz0PV9T.js";import"./github-hmyLGe0b.js";import"./ellipsis-Bz-dObmZ.js";import"./await_block-CgSfNRTu.js";import"./preload-helper-Dv6uf1Os.js";import"./index-BOPL8f7w.js";import"./IconFilePath-DrTaSdRG.js";import"./LanguageIcon-e6aGriGL.js";import"./next-edit-types-904A5ehg.js";import"./mcp-logo-CiDifGtg.js";import"./play-DmB9WugJ.js";import"./toggleHighContrast-CKn954qg.js";function Bt(r){let e,n,t;return{c(){e=ne("svg"),n=ne("g"),t=ne("path"),w(t,"id","Vector"),w(t,"fill-rule","evenodd"),w(t,"clip-rule","evenodd"),w(t,"d","M8.09854 1.54233C4.197 1.54233 1.03418 4.70515 1.03418 8.60668C1.03418 12.5081 4.197 15.671 8.09854 15.671C12.0001 15.671 15.1628 12.5081 15.1628 8.60668C15.1628 4.70515 12.0001 1.54233 8.09854 1.54233ZM2.04752 8.60668C2.04752 5.2648 4.75665 2.55566 8.09854 2.55566C11.4404 2.55566 14.1495 5.2648 14.1495 8.60668C14.1495 11.9486 11.4404 14.6577 8.09854 14.6577C4.75665 14.6577 2.04752 11.9486 2.04752 8.60668ZM10.9348 6.51374C11.1043 6.27285 11.0465 5.94016 10.8056 5.77064C10.5647 5.60113 10.232 5.65899 10.0625 5.89988L7.05305 10.1765L5.81256 8.91301C5.6062 8.70283 5.26852 8.69973 5.05834 8.9061C4.84816 9.11246 4.84506 9.45013 5.05143 9.66031L6.74032 11.3805C6.85121 11.4934 7.00655 11.5512 7.16431 11.5383C7.32207 11.5255 7.46595 11.4432 7.55704 11.3137L10.9348 6.51374Z"),w(t,"fill","currentColor"),w(e,"width","16"),w(e,"height","16"),w(e,"viewBox","0 0 16 16"),w(e,"fill","none"),w(e,"xmlns","http://www.w3.org/2000/svg")},m(s,l){C(s,e,l),E(e,n),E(n,t)},p:F,i:F,o:F,d(s){s&&M(e)}}}class Rt extends Y{constructor(e){super(),J(this,e,null,Bt,X,{})}}function zt(r){let e;return{c(){e=Te(r[2])},m(n,t){C(n,e,t)},p(n,t){4&t&&He(e,n[2])},d(n){n&&M(e)}}}function ve(r){let e,n,t;return n=new et({props:{variant:"ghost",color:"neutral",size:1,$$slots:{default:[Wt]},$$scope:{ctx:r}}}),n.$on("click",r[5]),{c(){e=L("div"),x(n.$$.fragment),w(e,"class","c-expandable-log-toggle svelte-awg7ah")},m(s,l){C(s,e,l),y(n,e,null),t=!0},p(s,l){const a={};4104&l&&(a.$$scope={dirty:l,ctx:s}),n.$set(a)},i(s){t||(g(n.$$.fragment,s),t=!0)},o(s){p(n.$$.fragment,s),t=!1},d(s){s&&M(e),b(n)}}}function qt(r){let e,n;return e=new Ft({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ut(r){let e,n;return e=new Ht({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wt(r){let e,n,t,s;const l=[Ut,qt],a=[];function i(c,o){return c[3]?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),C(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e!==u&&(A(),p(a[u],1,1,()=>{a[u]=null}),T(),n=a[e],n||(n=a[e]=l[e](c),n.c()),g(n,1),n.m(t.parentNode,t))},i(c){s||(g(n),s=!0)},o(c){p(n),s=!1},d(c){c&&M(t),a[e].d(c)}}}function Dt(r){let e,n,t,s,l,a,i,c;s=new Ee({props:{size:1,type:"monospace",$$slots:{default:[zt]},$$scope:{ctx:r}}});let o=r[4]&&ve(r);return{c(){e=L("div"),n=L("div"),t=L("div"),x(s.$$.fragment),i=B(),o&&o.c(),w(t,"class",l="c-expandable-log-content c-expandable-log-content--lines-"+r[1]+" svelte-awg7ah"),Ae(()=>r[11].call(t)),w(n,"class","c-expandable-log-preview svelte-awg7ah"),N(n,"c-expandable-log-preview--expanded",r[3]),N(n,"c-expandable-log-preview--single-line",!r[4]),w(e,"class","c-expandable-log svelte-awg7ah")},m(u,$){C(u,e,$),E(e,n),E(n,t),y(s,t,null),a=rt(t,r[11].bind(t)),E(n,i),o&&o.m(n,null),c=!0},p(u,[$]){const m={};4100&$&&(m.$$scope={dirty:$,ctx:u}),s.$set(m),(!c||2&$&&l!==(l="c-expandable-log-content c-expandable-log-content--lines-"+u[1]+" svelte-awg7ah"))&&w(t,"class",l),u[4]?o?(o.p(u,$),16&$&&g(o,1)):(o=ve(u),o.c(),g(o,1),o.m(n,null)):o&&(A(),p(o,1,1,()=>{o=null}),T()),(!c||8&$)&&N(n,"c-expandable-log-preview--expanded",u[3]),(!c||16&$)&&N(n,"c-expandable-log-preview--single-line",!u[4])},i(u){c||(g(s.$$.fragment,u),g(o),c=!0)},o(u){p(s.$$.fragment,u),p(o),c=!1},d(u){u&&M(e),b(s),a(),o&&o.d()}}}function Zt(r,e,n){let t,s,l,a,i,c,o,u,{logs:$}=e,m=!1;return r.$$set=d=>{"logs"in d&&n(6,$=d.logs)},r.$$.update=()=>{64&r.$$.dirty&&n(2,t=$.replace(/\r/g,`
`)),1&r.$$.dirty&&n(10,s=u/6),1028&r.$$.dirty&&n(9,l=t.trim().split(`
`).map(d=>Math.max(1,Math.ceil(d.length/s)))),512&r.$$.dirty&&n(7,a=l.reduce((d,f)=>d+f,0)),512&r.$$.dirty&&n(8,i=l[l.length-1]),256&r.$$.dirty&&n(1,c=i>1?2:1),130&r.$$.dirty&&n(4,o=a>c)},[u,c,t,m,o,function(){n(3,m=!m)},$,a,i,l,s,function(){u=this.clientWidth,n(0,u)}]}class Ot extends Y{constructor(e){super(),J(this,e,Zt,Dt,X,{logs:6})}}function we(r,e,n){const t=r.slice();return t[12]=e[n],t}function xe(r){let e,n,t,s=O(r[2].steps),l=[];for(let i=0;i<s.length;i+=1)l[i]=be(we(r,s,i));const a=i=>p(l[i],1,1,()=>{l[i]=null});return{c(){e=L("div"),n=L("div");for(let i=0;i<l.length;i+=1)l[i].c();w(n,"class","c-agent-setup-logs svelte-197jmbm"),w(e,"class","c-agent-setup-logs-container svelte-197jmbm"),N(e,"c-agent-setup-logs-container--loading",!r[1])},m(i,c){C(i,e,c),E(e,n);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,null);r[10](e),t=!0},p(i,c){if(52&c){let o;for(s=O(i[2].steps),o=0;o<s.length;o+=1){const u=we(i,s,o);l[o]?(l[o].p(u,c),g(l[o],1)):(l[o]=be(u),l[o].c(),g(l[o],1),l[o].m(n,null))}for(A(),o=s.length;o<l.length;o+=1)a(o);T()}(!t||2&c)&&N(e,"c-agent-setup-logs-container--loading",!i[1])},i(i){if(!t){for(let c=0;c<s.length;c+=1)g(l[c]);t=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)p(l[c]);t=!1},d(i){i&&M(e),Ne(l,i),r[10](null)}}}function Gt(r){let e,n;return{c(){e=L("div"),w(e,"class",n="c-agent-setup-log-status-dot c-agent-setup-log-status-dot--"+r[12].status+" svelte-197jmbm")},m(t,s){C(t,e,s)},p(t,s){4&s&&n!==(n="c-agent-setup-log-status-dot c-agent-setup-log-status-dot--"+t[12].status+" svelte-197jmbm")&&w(e,"class",n)},i:F,o:F,d(t){t&&M(e)}}}function Vt(r){let e,n,t;n=new Et({});let s=[qe("error"),{style:"color: var(--ds-color-a11);"}],l={};for(let a=0;a<s.length;a+=1)l=Be(l,s[a]);return{c(){e=L("div"),x(n.$$.fragment),Re(e,l),N(e,"svelte-197jmbm",!0)},m(a,i){C(a,e,i),y(n,e,null),t=!0},p(a,i){N(e,"svelte-197jmbm",!0)},i(a){t||(g(n.$$.fragment,a),t=!0)},o(a){p(n.$$.fragment,a),t=!1},d(a){a&&M(e),b(n)}}}function Kt(r){let e,n,t;n=new Rt({});let s=[qe("success"),{style:"color: var(--ds-color-a11);"}],l={};for(let a=0;a<s.length;a+=1)l=Be(l,s[a]);return{c(){e=L("div"),x(n.$$.fragment),Re(e,l),N(e,"svelte-197jmbm",!0)},m(a,i){C(a,e,i),y(n,e,null),t=!0},p(a,i){N(e,"svelte-197jmbm",!0)},i(a){t||(g(n.$$.fragment,a),t=!0)},o(a){p(n.$$.fragment,a),t=!1},d(a){a&&M(e),b(n)}}}function Pt(r){let e,n;return e=new ze({props:{size:1}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Qt(r){let e,n,t,s;const l=[Pt,Kt,Vt,Gt],a=[];function i(c,o){return c[12].status===q.running?0:c[12].status===q.success?1:c[12].status===q.failure?2:3}return n=i(r),t=a[n]=l[n](r),{c(){e=L("div"),t.c(),w(e,"class","c-agent-setup-log-status-icon svelte-197jmbm")},m(c,o){C(c,e,o),a[n].m(e,null),s=!0},p(c,o){let u=n;n=i(c),n===u?a[n].p(c,o):(A(),p(a[u],1,1,()=>{a[u]=null}),T(),t=a[n],t?t.p(c,o):(t=a[n]=l[n](c),t.c()),g(t,1),t.m(e,null))},i(c){s||(g(t),s=!0)},o(c){p(t),s=!1},d(c){c&&M(e),a[n].d()}}}function Yt(r){let e,n=r[12].step_description+"";return{c(){e=Te(n)},m(t,s){C(t,e,s)},p(t,s){4&s&&n!==(n=t[12].step_description+"")&&He(e,n)},d(t){t&&M(e)}}}function Jt(r){let e,n;return e=new St({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ye(r){let e,n,t,s;return n=new Ot({props:{logs:r[12].logs}}),{c(){e=L("div"),x(n.$$.fragment),w(e,"class","c-agent-setup-log-content svelte-197jmbm")},m(l,a){C(l,e,a),y(n,e,null),s=!0},p(l,a){const i={};4&a&&(i.logs=l[12].logs),n.$set(i)},i(l){s||(g(n.$$.fragment,l),l&&Ae(()=>{s&&(t||(t=pe(e,he,{},!0)),t.run(1))}),s=!0)},o(l){p(n.$$.fragment,l),l&&(t||(t=pe(e,he,{},!1)),t.run(0)),s=!1},d(l){l&&M(e),b(n),l&&t&&t.end()}}}function be(r){let e,n,t,s,l,a,i,c,o,u,$,m,d;s=new Nt({props:{content:r[4](r[12].status),triggerOn:[jt.Hover],$$slots:{default:[Qt]},$$scope:{ctx:r}}}),i=new Ee({props:{size:1,weight:"medium",$$slots:{default:[Yt]},$$scope:{ctx:r}}}),u=new et({props:{variant:"ghost",color:"neutral",size:1,title:"Open logs in new file",$$slots:{default:[Jt]},$$scope:{ctx:r}}}),u.$on("click",function(){return r[9](r[12])});let f=r[12].logs&&r[12].status!==q.success&&ye(r);return{c(){e=L("div"),n=L("div"),t=L("div"),x(s.$$.fragment),l=B(),a=L("div"),x(i.$$.fragment),c=B(),o=L("div"),x(u.$$.fragment),$=B(),f&&f.c(),m=B(),w(t,"class","c-agent-setup-log-status svelte-197jmbm"),w(a,"class","c-agent-setup-log-step-description svelte-197jmbm"),w(o,"class","c-expandable-log-open svelte-197jmbm"),w(n,"class","c-agent-setup-log-header svelte-197jmbm"),w(e,"class","c-agent-setup-log-step svelte-197jmbm")},m(h,k){C(h,e,k),E(e,n),E(n,t),y(s,t,null),E(n,l),E(n,a),y(i,a,null),E(n,c),E(n,o),y(u,o,null),E(e,$),f&&f.m(e,null),E(e,m),d=!0},p(h,k){r=h;const R={};4&k&&(R.content=r[4](r[12].status)),32772&k&&(R.$$scope={dirty:k,ctx:r}),s.$set(R);const H={};32772&k&&(H.$$scope={dirty:k,ctx:r}),i.$set(H);const z={};32768&k&&(z.$$scope={dirty:k,ctx:r}),u.$set(z),r[12].logs&&r[12].status!==q.success?f?(f.p(r,k),4&k&&g(f,1)):(f=ye(r),f.c(),g(f,1),f.m(e,m)):f&&(A(),p(f,1,1,()=>{f=null}),T())},i(h){d||(g(s.$$.fragment,h),g(i.$$.fragment,h),g(u.$$.fragment,h),g(f),d=!0)},o(h){p(s.$$.fragment,h),p(i.$$.fragment,h),p(u.$$.fragment,h),p(f),d=!1},d(h){h&&M(e),b(s),b(i),b(u),f&&f.d()}}}function Xt(r){let e,n,t=r[2]&&r[2].steps&&r[2].steps.length>0&&xe(r);return{c(){t&&t.c(),e=U()},m(s,l){t&&t.m(s,l),C(s,e,l),n=!0},p(s,[l]){s[2]&&s[2].steps&&s[2].steps.length>0?t?(t.p(s,l),4&l&&g(t,1)):(t=xe(s),t.c(),g(t,1),t.m(e.parentNode,e)):t&&(A(),p(t,1,1,()=>{t=null}),T())},i(s){n||(g(t),n=!0)},o(s){p(t),n=!1},d(s){s&&M(e),t&&t.d(s)}}}function en(r,e,n){let t,s,l,a,i;const c=V(Xe.key);G(r,c,m=>n(8,a=m));const o=V("chatModel");let u=!1;function $(m){m&&o&&o.extensionClient.openScratchFile(m,"plaintext")}return r.$$.update=()=>{var m;if(256&r.$$.dirty&&n(7,t=(m=a==null?void 0:a.currentAgent)==null?void 0:m.status),128&r.$$.dirty&&n(1,s=t!==fe.agentStarting),256&r.$$.dirty&&n(2,l=a==null?void 0:a.agentSetupLogs),129&r.$$.dirty&&i&&t===fe.agentStarting&&setTimeout(()=>{i.scrollIntoView({behavior:"smooth",block:"start"})},500),67&r.$$.dirty)if(s&&!u&&i){n(6,u=!0);const d=i.closest(".c-msg-list");d&&setTimeout(()=>{d.scrollTo({top:d.scrollHeight,behavior:"smooth"})},300)}else!s&&u&&n(6,u=!1)},[i,s,l,c,function(m){switch(m){case q.running:return"Running";case q.success:return"Success";case q.failure:return"Failed";default:return"Unknown"}},$,u,t,a,m=>$(m.logs),function(m){Fe[m?"unshift":"push"](()=>{i=m,n(0,i)})}]}class tn extends Y{constructor(e){super(),J(this,e,en,Xt,X,{})}}function Ce(r,e,n){const t=r.slice();t[36]=e[n],t[39]=n;const s=t[39]+1===t[11].length;return t[37]=s,t}function Me(r,e,n){const t=r.slice();t[42]=e[n].turn,t[43]=e[n].idx;const s=t[43]+1===t[5].length;return t[44]=s,t}function je(r){let e,n;return e=new tn({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function nn(r){let e,n,t,s;const l=[$n,mn],a=[];function i(c,o){return c[16].enableRichCheckpointInfo?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),C(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e===u?a[e].p(c,o):(A(),p(a[u],1,1,()=>{a[u]=null}),T(),n=a[e],n?n.p(c,o):(n=a[e]=l[e](c),n.c()),g(n,1),n.m(t.parentNode,t))},i(c){s||(g(n),s=!0)},o(c){p(n),s=!1},d(c){c&&M(t),a[e].d(c)}}}function sn(r){let e,n;return e=new ht({props:{chatModel:r[1],turn:r[42],turnIndex:r[43],isLastTurn:r[44],messageListContainer:r[0]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.turn=t[42]),2048&s[0]&&(l.turnIndex=t[43]),2080&s[0]&&(l.isLastTurn=t[44]),1&s[0]&&(l.messageListContainer=t[0]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function rn(r){let e,n;return e=new vt({props:{stage:r[42].stage,iterationId:r[42].iterationId,stageCount:r[42].stageCount}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.stage=t[42].stage),2048&s[0]&&(l.iterationId=t[42].iterationId),2048&s[0]&&(l.stageCount=t[42].stageCount),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ln(r){let e,n;return e=new wt({props:{chatModel:r[1],msg:r[42].response_text??""}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.msg=t[42].response_text??""),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function on(r){let e,n;return e=new At({props:{markdown:r[42].response_text??"",messageListContainer:r[0]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.markdown=t[42].response_text??""),1&s[0]&&(l.messageListContainer=t[0]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function an(r){let e,n;function t(){return r[29](r[42])}return e=new We({props:{turn:r[42],preamble:It,resendTurn:t,$$slots:{default:[gn]},$$scope:{ctx:r}}}),{c(){x(e.$$.fragment)},m(s,l){y(e,s,l),n=!0},p(s,l){r=s;const a={};2048&l[0]&&(a.turn=r[42]),2052&l[0]&&(a.resendTurn=t),2176&l[0]|65536&l[1]&&(a.$$scope={dirty:l,ctx:r}),e.$set(a)},i(s){n||(g(e.$$.fragment,s),n=!0)},o(s){p(e.$$.fragment,s),n=!1},d(s){b(e,s)}}}function cn(r){let e,n;return e=new xt({props:{flagsModel:r[12],turn:r[42]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};4096&s[0]&&(l.flagsModel=t[12]),2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function un(r){let e,n;return e=new We({props:{turn:r[42]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function mn(r){let e,n;return e=new Ct({props:{turn:r[42]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function $n(r){let e,n;return e=new Mt({props:{turn:r[42]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function gn(r){let e,n;return e=new Tt({props:{conversationModel:r[7],turn:r[42]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};128&s[0]&&(l.conversationModel=t[7]),2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function _e(r){let e,n,t,s;function l(){return r[30](r[42])}return{c(){e=L("div"),w(e,"class","c-msg-list__turn-seen")},m(a,i){C(a,e,i),t||(s=re(n=pt.call(null,e,{onSeen:l,track:r[42].seen_state!==le.seen})),t=!0)},p(a,i){r=a,n&&Ue(n.update)&&2048&i[0]&&n.update.call(null,{onSeen:l,track:r[42].seen_state!==le.seen})},d(a){a&&M(e),t=!1,s()}}}function Se(r,e){let n,t,s,l,a,i,c,o,u,$,m,d,f,h,k=de(e[42]);const R=[un,cn,an,on,ln,rn,sn,nn],H=[];function z(j,_){return 2048&_[0]&&(t=null),2048&_[0]&&(s=null),2048&_[0]&&(l=null),2048&_[0]&&(a=null),2048&_[0]&&(i=null),2048&_[0]&&(c=null),2048&_[0]&&(o=null),2048&_[0]&&(u=null),t==null&&(t=!!De(j[42])),t?0:(s==null&&(s=!!Oe(j[42])),s?1:(l==null&&(l=!!Ge(j[42])),l?2:(a==null&&(a=!!Ve(j[42])),a?3:(i==null&&(i=!!Ke(j[42])),i?4:(c==null&&(c=!!Pe(j[42])),c?5:(o==null&&(o=!!(oe(j[42])||Ze(j[42])||Qe(j[42]))),o?6:(u==null&&(u=!(!ae(j[42])||j[42].status!==Ye.success)),u?7:-1)))))))}~($=z(e,[-1,-1]))&&(m=H[$]=R[$](e));let I=k&&_e(e);return{key:r,first:null,c(){n=U(),m&&m.c(),d=B(),I&&I.c(),f=U(),this.first=n},m(j,_){C(j,n,_),~$&&H[$].m(j,_),C(j,d,_),I&&I.m(j,_),C(j,f,_),h=!0},p(j,_){let W=$;$=z(e=j,_),$===W?~$&&H[$].p(e,_):(m&&(A(),p(H[W],1,1,()=>{H[W]=null}),T()),~$?(m=H[$],m?m.p(e,_):(m=H[$]=R[$](e),m.c()),g(m,1),m.m(d.parentNode,d)):m=null),2048&_[0]&&(k=de(e[42])),k?I?I.p(e,_):(I=_e(e),I.c(),I.m(f.parentNode,f)):I&&(I.d(1),I=null)},i(j){h||(g(m),h=!0)},o(j){p(m),h=!1},d(j){j&&(M(n),M(d),M(f)),~$&&H[$].d(j),I&&I.d(j)}}}function Le(r){let e,n,t,s;const l=[fn,dn,pn],a=[];function i(o,u){return o[13]===Q.running?0:o[13]===Q.awaitingUserAction?1:o[8]?2:-1}function c(o,u){return u===0?function($){var f;const m=$.slice(),d=(f=m[7])==null?void 0:f.lastExchange;return m[40]=d,m}(o):o}return~(e=i(r))&&(n=a[e]=l[e](c(r,e))),{c(){n&&n.c(),t=U()},m(o,u){~e&&a[e].m(o,u),C(o,t,u),s=!0},p(o,u){let $=e;e=i(o),e===$?~e&&a[e].p(c(o,e),u):(n&&(A(),p(a[$],1,1,()=>{a[$]=null}),T()),~e?(n=a[e],n?n.p(c(o,e),u):(n=a[e]=l[e](c(o,e)),n.c()),g(n,1),n.m(t.parentNode,t)):n=null)},i(o){s||(g(n),s=!0)},o(o){p(n),s=!1},d(o){o&&M(t),~e&&a[e].d(o)}}}function pn(r){let e,n;return e=new dt({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function dn(r){let e,n,t,s;return e=new ft({}),{c(){x(e.$$.fragment),n=B(),t=L("div"),w(t,"class","c-agent-running-spacer svelte-1trj6wj")},m(l,a){y(e,l,a),C(l,n,a),C(l,t,a),s=!0},p:F,i(l){s||(g(e.$$.fragment,l),s=!0)},o(l){p(e.$$.fragment,l),s=!1},d(l){l&&(M(n),M(t)),b(e,l)}}}function fn(r){let e,n,t,s;const l=[wn,vn,hn],a=[];function i(o,u){var $,m;return($=o[40])!=null&&$.isRetriable&&((m=o[40])!=null&&m.display_error_message)?0:o[17]?1:2}function c(o,u){return u===1?function($){const m=$.slice(),d=m[7].getLastToolUseState();return m[41]=d,m}(o):o}return e=i(r),n=a[e]=l[e](c(r,e)),{c(){n.c(),t=U()},m(o,u){a[e].m(o,u),C(o,t,u),s=!0},p(o,u){let $=e;e=i(o),e===$?a[e].p(c(o,e),u):(A(),p(a[$],1,1,()=>{a[$]=null}),T(),n=a[e],n?n.p(c(o,e),u):(n=a[e]=l[e](c(o,e)),n.c()),g(n,1),n.m(t.parentNode,t))},i(o){s||(g(n),s=!0)},o(o){p(n),s=!1},d(o){o&&M(t),a[e].d(o)}}}function hn(r){let e,n;return e=new yt({}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function vn(r){let e,n,t,s;const l=[yn,xn],a=[];function i(c,o){return c[41].phase!==Je.running?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),C(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e!==u&&(A(),p(a[u],1,1,()=>{a[u]=null}),T(),n=a[e],n||(n=a[e]=l[e](c),n.c()),g(n,1),n.m(t.parentNode,t))},i(c){s||(g(n),s=!0)},o(c){p(n),s=!1},d(c){c&&M(t),a[e].d(c)}}}function wn(r){let e,n;return e=new bt({props:{message:r[40].display_error_message}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};128&s[0]&&(l.message=t[40].display_error_message),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function xn(r){let e;return{c(){e=L("div"),w(e,"class","c-agent-running-spacer svelte-1trj6wj")},m(n,t){C(n,e,t)},i:F,o:F,d(n){n&&M(e)}}}function yn(r){let e,n,t;return n=new ze({props:{size:1}}),{c(){e=L("div"),x(n.$$.fragment),w(e,"class","c-agent-running-spinner svelte-1trj6wj")},m(s,l){C(s,e,l),y(n,e,null),t=!0},i(s){t||(g(n.$$.fragment,s),t=!0)},o(s){p(n.$$.fragment,s),t=!1},d(s){s&&M(e),b(n)}}}function bn(r){let e,n,t,s=[],l=new Map,a=O(r[36]);const i=o=>o[42].request_id??`no-request-id-${o[43]}`;for(let o=0;o<a.length;o+=1){let u=Me(r,a,o),$=i(u);l.set($,s[o]=Se($,u))}let c=r[37]&&Le(r);return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=B(),c&&c.c(),n=B()},m(o,u){for(let $=0;$<s.length;$+=1)s[$]&&s[$].m(o,u);C(o,e,u),c&&c.m(o,u),C(o,n,u),t=!0},p(o,u){33626279&u[0]&&(a=O(o[36]),A(),s=at(s,u,i,1,o,a,l,e.parentNode,ct,Se,e,Me),T()),o[37]?c?(c.p(o,u),2048&u[0]&&g(c,1)):(c=Le(o),c.c(),g(c,1),c.m(n.parentNode,n)):c&&(A(),p(c,1,1,()=>{c=null}),T())},i(o){if(!t){for(let u=0;u<a.length;u+=1)g(s[u]);g(c),t=!0}},o(o){for(let u=0;u<s.length;u+=1)p(s[u]);p(c),t=!1},d(o){o&&(M(e),M(n));for(let u=0;u<s.length;u+=1)s[u].d(o);c&&c.d(o)}}}function ke(r){let e,n;return e=new gt({props:{class:"c-msg-list__item--grouped",chatModel:r[1],isLastItem:r[37],userControlsScroll:r[3],requestId:r[36][0].turn.request_id,releaseScroll:r[31],messageListContainer:r[0],minHeight:r[37]?r[10]:0,$$slots:{default:[bn]},$$scope:{ctx:r}}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.isLastItem=t[37]),8&s[0]&&(l.userControlsScroll=t[3]),2048&s[0]&&(l.requestId=t[36][0].turn.request_id),8&s[0]&&(l.releaseScroll=t[31]),1&s[0]&&(l.messageListContainer=t[0]),3072&s[0]&&(l.minHeight=t[37]?t[10]:0),211367&s[0]|65536&s[1]&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Cn(r){var $;let e,n,t,s,l,a,i=(($=r[6])==null?void 0:$.isActive)&&je(),c=O(r[11]),o=[];for(let m=0;m<c.length;m+=1)o[m]=ke(Ce(r,c,m));const u=m=>p(o[m],1,1,()=>{o[m]=null});return{c(){e=L("div"),i&&i.c(),n=B();for(let m=0;m<o.length;m+=1)o[m].c();w(e,"class","c-msg-list svelte-1trj6wj"),N(e,"c-msg-list--minimal",!r[16].fullFeatured)},m(m,d){C(m,e,d),i&&i.m(e,null),E(e,n);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(e,null);r[32](e),s=!0,l||(a=[re(ut.call(null,e,{onScrollIntoBottom:r[22],onScrollAwayFromBottom:r[23],onScroll:r[33]})),re(t=mt.call(null,e,{onHeightChange:r[34]}))],l=!0)},p(m,d){var f;if((f=m[6])!=null&&f.isActive?i?64&d[0]&&g(i,1):(i=je(),i.c(),g(i,1),i.m(e,n)):i&&(A(),p(i,1,1,()=>{i=null}),T()),33766831&d[0]){let h;for(c=O(m[11]),h=0;h<c.length;h+=1){const k=Ce(m,c,h);o[h]?(o[h].p(k,d),g(o[h],1)):(o[h]=ke(k),o[h].c(),g(o[h],1),o[h].m(e,null))}for(A(),h=c.length;h<o.length;h+=1)u(h);T()}t&&Ue(t.update)&&16&d[0]&&t.update.call(null,{onHeightChange:m[34]}),(!s||65536&d[0])&&N(e,"c-msg-list--minimal",!m[16].fullFeatured)},i(m){if(!s){g(i);for(let d=0;d<c.length;d+=1)g(o[d]);s=!0}},o(m){p(i),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)p(o[d]);s=!1},d(m){m&&M(e),i&&i.d(),Ne(o,m),r[32](null),l=!1,ot(a)}}}function Ie(r){let e,n;return e=new $t({props:{messageListElement:r[0],showScrollDown:r[9]}}),{c(){x(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};1&s[0]&&(l.messageListElement=t[0]),512&s[0]&&(l.showScrollDown=t[9]),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Mn(r){let e,n,t,s;n=new it({props:{$$slots:{default:[Cn]},$$scope:{ctx:r}}});let l=!r[15].doHideFloatingButtons&&Ie(r);return{c(){e=L("div"),x(n.$$.fragment),t=B(),l&&l.c(),w(e,"class","c-msg-list-container svelte-1trj6wj"),w(e,"data-testid","chat-message-list"),N(e,"c-msg-list--minimal",!r[16].fullFeatured)},m(a,i){C(a,e,i),y(n,e,null),E(e,t),l&&l.m(e,null),s=!0},p(a,i){const c={};212479&i[0]|65536&i[1]&&(c.$$scope={dirty:i,ctx:a}),n.$set(c),a[15].doHideFloatingButtons?l&&(A(),p(l,1,1,()=>{l=null}),T()):l?(l.p(a,i),32768&i[0]&&g(l,1)):(l=Ie(a),l.c(),g(l,1),l.m(e,null)),(!s||65536&i[0])&&N(e,"c-msg-list--minimal",!a[16].fullFeatured)},i(a){s||(g(n.$$.fragment,a),g(l),s=!0)},o(a){p(n.$$.fragment,a),p(l),s=!1},d(a){a&&M(e),b(n),l&&l.d()}}}function jn(r,e,n){let t,s,l,a,i,c,o,u,$,m,d,f,h,k,R,H=F,z=F,I=()=>(z(),z=se(_,v=>n(26,d=v)),_),j=F;r.$$.on_destroy.push(()=>H()),r.$$.on_destroy.push(()=>z()),r.$$.on_destroy.push(()=>j());let{chatModel:_}=e;I();let{onboardingWorkspaceModel:W}=e,{msgListElement:K}=e;const tt=V("agentConversationModel"),{agentExchangeStatus:ce,isCurrConversationAgentic:ie}=tt;G(r,ce,v=>n(27,f=v)),G(r,ie,v=>n(17,R=v));const ue=V(Xe.key);G(r,ue,v=>n(6,$=v));const me=V(Lt);G(r,me,v=>n(28,h=v));let Z=!1;function ee(){n(3,Z=!0)}lt(()=>{var v;((v=m.lastExchange)==null?void 0:v.seen_state)===le.unseen&&ee()});let te=0;const $e=v=>m.markSeen(v);let ge=!1;return r.$$set=v=>{"chatModel"in v&&I(n(1,_=v.chatModel)),"onboardingWorkspaceModel"in v&&n(2,W=v.onboardingWorkspaceModel),"msgListElement"in v&&n(0,K=v.msgListElement)},r.$$.update=()=>{var v;if(268435456&r.$$.dirty[0]&&n(15,t=h??kt),67108864&r.$$.dirty[0]&&(n(14,s=d.currentConversationModel),H(),H=se(s,S=>n(7,m=S))),134217792&r.$$.dirty[0]&&n(13,l=$!=null&&$.isActive?$.isCurrentAgentRunning?Q.running:Q.notRunning:f),67108864&r.$$.dirty[0]&&(n(12,a=d.flags),j(),j=se(a,S=>n(16,k=S))),192&r.$$.dirty[0]&&n(5,i=$!=null&&$.isActive?$.getCurrentChatHistory():m.chatHistory.filter(S=>oe(S)||De(S)||Ze(S)||Oe(S)||Ge(S)||Ve(S)||Ke(S)||Pe(S)||Qe(S)||ae(S))),32&r.$$.dirty[0]&&n(11,c=i.reduce((S,D,P)=>(oe(D)&&_t(D)&&S.length>0||ae(D)&&S.length>0?S[S.length-1].push({turn:D,idx:P}):S.push([{turn:D,idx:P}]),S),[])),16&r.$$.dirty[0]&&n(10,o=te),8&r.$$.dirty[0]&&n(9,u=Z),192&r.$$.dirty[0]){const S=(v=m==null?void 0:m.lastExchange)==null?void 0:v.status,D=S===Ye.cancelled,P=m==null?void 0:m.getLastToolUseState().phase,nt=P===Je.cancelled,st=$==null?void 0:$.isActive;n(8,ge=!st&&(D||nt))}},[K,_,W,Z,te,i,$,m,ge,u,o,c,a,l,s,t,k,R,ce,ie,ue,me,function(){n(3,Z=!1)},function(){n(3,Z=!0)},ee,$e,d,f,h,v=>W.retryProjectSummary(v),v=>$e(v),()=>n(3,Z=!0),function(v){Fe[v?"unshift":"push"](()=>{K=v,n(0,K)})},v=>{v<=1&&ee()},v=>n(4,te=v)]}class is extends Y{constructor(e){super(),J(this,e,jn,Mn,X,{chatModel:1,onboardingWorkspaceModel:2,msgListElement:0},null,[-1,-1])}}export{is as default};
